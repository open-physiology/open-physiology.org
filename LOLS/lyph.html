<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
<head>
<title>Lyphs Documentation</title>

<link rel="stylesheet" href="/Skeleton/stylesheets/base.css">
<link rel="stylesheet" href="/Skeleton/stylesheets/skeleton.css">

<style media='screen' type='text/css'>
#maindiv, #apidiv, #introdiv
{
  background-image: url(http://open-physiology.org/owlkb/swirly.png);
  background-position: center;
  background-size: contain;
  background-repeat: no-repeat;
}
</style>

</head>
<body>

<div class='container'>

  <div class='sixteen columns'>
    <h1 id='topdiv'>Lyphs Documentation</h1>
    <hr>
  </div>

  <div class='twelve columns' id='introdiv'>
    <div id='about'>
      <h2>About</h2>

      <h4>&raquo; <a href='#apidiv'>Quickjump to API section</a></h4>

      <p>
        Lyphs are special data structures developed for ApiNATOMY 2.
        They are intended for automated reasoning about flow
        processes through the body.
      </p>

      <h3>Lyphs</h3>

      <p>
        There are three types of lyph:
        <ul>
          <li>
            &raquo; Basic lyph: A <i>basic</i> lyph is just a term from a reference ontology
            (typically FMA or CHEBI).
          </li>
          <li>
            &raquo; Mix lyph: A <i>mix</i> lyph is an unordered list (with size at least 2) of <i>layers</i> (layers are
            defined below).
          </li>
          <li>
            &raquo; Shell lyph: A <i>shell</i> lyph is an ordered list (with size at least 2) of layers (defined below).
          </li>
        </ul>
      Every lyph has an <i>id</i>, used to retrieve the lyph from the database.
      </p>

      <h3>Layers</h3>
      <p>
        A <i>layer</i> is a lyph together with a thickness and a color.
        If the layer consists of lyph X with thickness Y, we intuitively think
        of it as a right hollow cylinder constructed out of X (considered as
        a material), with thickness Y.  A layer's thickness and/or color can
        also be ``unspecified''.
      </p>
      <p>
        Every layer has an <i>id</i>, used for retrieval from the database.
      </p>

      <h3>Lyphnodes</h3>
      <p>
        A <i>lyphnode</i> is an entity whose only purpose is to serve as an
        endpoint of a <i>lyphedge</i> (defined below).  Every lyphnode has an
        <i>id</i>, for retrieval from the database.
      </p>
      <p>
        Every lyphnode also has a list of <i>exits</i> (an <i>exit</i> consists
        of a 'to' destination---which is another lyphnode---and a 'via' lyphedge).
        These <i>exits</i> are not user-defined; rather, they are automatically
        calculated from the lyphedges.
      </p>

      <h3>Lyphedges</h3>
      <p>
        A <i>lyphedge</i> consists of a 'from' vertex (which is a lyphnode,
        defined above); a 'to' vertex (also a lyphnode); a 'name' (which, in
        practice, may be a very verbose description of a segment of flow
        in the body); a 'type' (see below); a 'lyph' (which should be a 'shell'
        type of lyph); and an 'fma' term.  Only the 'from' and 'to' fields are
        mandatory, the rest maybe unspecified.
      </p>
      <p>
        The 'type' of a lyphedge is one of the following:
        <ul>
          <li>1: arterial segment</li>
          <li>2: microcirculation</li>
          <li>3: venous</li>
          <li>4: cardiac chamber</li>
        </ul>
      </p>
      <p>
        Every lyphedge also has an <i>id</i>, for retrieval from the database.
      </p>

      <h3>Lyphviews</h3>
      <p>
        A <i>lyphview</i> is a set of lyphnodes along with x-y-coordinates
        for those lyphnodes.  Every lyphview also has an <i>id</i>, for retrieval
        from the database.
      </p>
    </div>

    <div id='apidiv'>
      <h2>API</h2>
      <p>
        The Lyph API consists of commands which the user can send to LOLS via
        HTTP.  LOLS send its responses in JSON.  JSONP is supported.
      </p>

      <h3 id='apicmd_lyph'>lyph</h3>

      <p>
        Used to look up a lyph by its ID.
        <blockquote>
          Example: http://localhost:5052/lyph/LYPH_1
        </blockquote>
        Note: You can specify a term in a reference ontology in order to retrieve the corresponding <i>basic lyph</i>.
        <blockquote>
          Example: http://localhost:5052/lyph/CHEBI_37527
        </blockquote>
      </p>

      <h3 id='apicmd_layer'>layer</h3>
      <p>
        Used to look up a layer by its ID.
        <blockquote>
          Example: http://localhost:5052/layer/LAYER_1
        </blockquote>
      </p>

      <h3 id='apicmd_lyphview'>lyphview</h3>
      <p>
        Used to look up a lyphview by its ID.
        <blockquote>
          Example: http://localhost:5052/lyphview/1
        </blockquote>
      </p>

      <h3 id='apicmd_lyphedge'>lyphedge</h3>
      <p>
        Used to look up a lyphedge by its ID.
        <blockquote>
          Example: http://localhost:5052/lyphedge/6039
        </blockquote>
      </p>

      <h3 id='apicmd_lyphnode'>lyphnode</h3>
      <p>
        Used to look up a lyphnode by its ID.
        <blockquote>
          Example: http://localhost:5052/lyphnode/50022150_0
        </blockquote>
      </p>

      <h3 id='apicmd_lyphpath'>lyphpath</h3>
      <p>
        Used to compute the shortest path from one lyphnode to another.
        <blockquote>
          Example: http://localhost:5052/lyphpath/?from=50022150_0&to=50022153_0
        </blockquote>
        Optional arguments:
        <ul>
          <li>&raquo; filter: specify a filter lyph, the algorithm will only consider edges with lyphs that are sublyphs of the filter.</li>
          <li>&raquo; include_lyphless: specify ('yes' or 'no') whether lyphless edges should be considered, when performing a filtered search.  Default: no.</li>
        </ul>
      </p>

      <h3 id='apicmd_assignlyph'>assignlyph</h3>
      <p>
        Used to assign a lyph to an edge.
        <blockquote>
          Example: http://localhost:5052/assignlyph/?edge=5000&lyph=LYPH_5
        </blockquote>
        Will send an error message if the indicated lyph is inconsistent (not a sublyph of) any constraints previouly placed on the edge.
      </p>

      <h3 id='apicmd_lyph_along_path'>
      <p>
        Used to assign a lyph to every edge along a path.
        <blockquote>
          Example: http://localhost:5052/lyph_along_path/?from=5000&to=6000&lyph=LYPH_3
        </blockquote>
        Will send an error message (and not assign any lyphs) if any edge in the path has constraints preventing this lyph from being assigned to it.
        <ul><li>Optional arguments: Same as the "lyphpath" command</li></ul>
      </p>

      <h3 id='apicmd_constrain_along_path'>
      <p>
        Used to add a constraint to every edge along a path.
        <blockquote>
          Example: http://localhost:5052/constrain_along_path/?from=5000&to=6000&lyph=LYPH_3
        </blockquote>
        Will send an error message (and not assign any constraints) if any edge in the path has a lyph that already violates the constraint.
        <ul><li>Optional arguments: Same as the "lyphpath" command</li></ul>
      </p>

      <h3 id='apicmd_lyphview'>lyphview</h3>
      <p>
        Used to look up a lyphview by its ID.
        <blockquote>
          Example: http://localhost:5052/lyphview/1
        </blockquote>
      </p>

      <h3 id='apicmd_makelayer'>makelayer</h3>
      <p>
        Used to create a new layer (or, if the specified layer already exists, retrieve it).
        <ul>
          <li>Mandatory argument: material: the material of the layer (a lyph ID)</li>
          <li>Optional argument: thickness: the thickness of the layer</li>
          <li>Optional argument: color: the color of the layer</li>
        </ul>
        <blockquote>
          Example: http://localhost:5052/makelayer/?material=LYPH_1&thickness=5&color=red
        </blockquote>
      </p>

      <h3 id='apicmd_makelyph'>makelyph</h3>
        Used to create a new lyph (or, if the specified lyph already exists, create it).
        <ul>
          <li>
            Mandatory argument: name: a proposed name for the lyph.
            <ul>
              <li>Note: If a lyph already exists which matches everything else, then this proposed name will be discarded, in favor of the existing lyph's name.</li>
            </ul>
          </li>
          <li>
            Mandatory argument: type: mix or shell.
            <ul>
              <li>Note: To create a lyph of type 'basic', use the 'lyph' command (above).
            </ul>
          </li>
          <li>Mandatory arguments: layer1, layer2: specify layers of the lyph (by layer id)</li>
          <li>Optional arguments: layer3, layer4, etc: as above.
        </ul>
        <blockquote>
          Example: http://localhost:5052/makelyph/?name=my+lyph&type=mix&layer1=LAYER_5&layer2=LAYER_77&layer3=LAYER_4
        </blockquote>

      <h3 id='apicmd_makeview'>makeview</h3>
      Used to create a new lyphview (or, if the specified view already exists, retrieve it).
      <ul>
        <li>Optional arguments: node1, node2, node3, ...: The nodes in the lyphview</li>
        <li>Optional arguments: x1, x2, x3, ...: The x-coordinates of the nodes</li>
        <li>Optional arguments: y1, y2, y3, ...: The y-coordinates of the nodes</li>
      </ul>
      Each node must be given an x- and a y-coordinate.
      <blockquote>
        Example: http://localhost:5052/makeview/?node1=500&x1=3&y1=5&node2=9342&x2=0&y2=0&node3=654&x3=99&y3=50
      </blockquote>

      <h3 id='apicmd_makelyphnode'>makelyphnode</h3>
      Used to create a new lyphnode.  Takes no arguments.
      <blockquote>
        Example: http://localhost:5052/makelyphnode/
      </blockquote>
      Note: The lyphnode will not actually be saved to disk unless it is used in a lyphedge or lyphview.

      <h3 id='apicmd_makelyphedge'>makelyphedge</h3>
      Used to create a new lyphedge (or, if such a lyphedge already exists, retrieve it).
      <ul>
        <li>Mandatory argument: type: 1, 2, 3, or 4.  The meanings of these numbers are:
          <ul>
            <li>1: arterial segment</li>
            <li>2: microcirculation</li>
            <li>3: venous</li>
            <li>4: cardiac chamber</li>
          </ul>
        </li>
        <li>Optional argument: name: a description of the edge.</li>
        <li>Mandatory argument: from: the initial node of the edge (specified via lyphnode ID).</li>
        <li>Mandatory argument: to: the terminal node of the edge (specified via lyphnode ID).</li>
        <li>Optional argument: lyph: a lyph to describe the tube around the edge (specified via lyph ID).
        <li>Optional argument: fma: an FMA term (specified as a number, e.g., 7197 refers to FMA_7197).</li>
      </ul>
      <blockquote>
        Example: http://localhost:5052/makelyphedge/?type=1&name=mystery+artery&from=5432&to=57465&lyph=LYPH_5&fma=7197
      </blockquote>

      <h3 id='apicmd_editedge'>editedge</h3>
      <p>
        Used to edit an existing lyphedge.
        <ul>
          <li>Mandatory argument: edge: the ID of the edge to edit.</li>
          <li>Optional arguments: all the arguments that "makelyphedge" takes.</li>
        </ul>
      </p>

      <h3 id='apicmd_editlyph'>editlyph</h3>
      <p>
        Used to edit an existing lyph.
        <ul>
          <li>Mandatory argument: lyph: the ID of the lyph to edit.</li>
          <li>Optional arguments: name, type, ont</li>
        </ul>
      </p>

      <h3 id='apicmd_editview'>editview</h3>
      <p>
        Used to edit an existing lyphview.
        <ul>
          <li>Mandatory argument: view: the ID of the view to edit.</li>
          <li>Optional arguments: name</li>
        </ul>
      </p>

      <h3 id='apicmd_editlayer'>editlayer</h3>
      <p>
        Used to edit an existing layer.
        <ul>
          <li>Mandatory argument: layer: the ID of the layer to edit.</li>
          <li>Optional arguments: material, thickness</li>
        </ul>
      </p>

      <h3 id='apicmd_edgeconstrain'>edgeconstrain</h3>
      <p>
        Add a constraint to an edge.  A constraint is a lyph, and what it does is it restricts which lyphs can be assigned to the edge.  To be precise: only sublyphs of the constraint lyph will be allowed to be assigned to the edge.
        <blockquote>
          Example: http://localhost:5052/edgeconstrain/?edge=5000&lyph=LYPH_5
        </blockquote>
      </p>

      <h3 id='apicmd_sublyphs'>sublyphs</h3>
      <p>
        List the sublyphs of the indicated lyph.
        <ul>
          <li>Mandatory argument: lyph: which lyph to view the sublyphs of.
          <li>Optional argument: direct: ('yes' or 'no') whether to restrict to only show *direct* sublyphs (default: 'no').
        </ul>
        <blockquote>
          Example: http://localhost:5052/sublyphs/?lyph=LYPH_5&direct=yes
        </blockquote>
      </p>

      <h3 id='apicmd_all_lyphs'>all_lyphs</h3>
      <p>(Temporary command during development only) View all lyphs</p>

      <h3 id='apicmd_all_lyphnodes'>all_lyphnodes</h3>
      <p>(Temporary command during development only) View all lyphnodes</p>

      <h3 id='apicmd_all_lyphedges'>all_lyphedges</h3>
      <p>(Temporary command during development only) View all lyphedges</p>

      <h3 id='apicmd_all_lyphviews'>all_lyphviews</h3>
      <p>(Temporary command during development only) View all lyphviews</p>

      <h3 id='apicmd_all_ont_terms'>all_ont_terms</h3>
      <p>(Temporary command during development only) View all ontology terms</p>

      <h3 id='apicmd_lyph_hierarchy'>lyph_hierarchy</h3>
      <p>(Temporary command during development only) View the lyph hierarchy</p>

      <h3 id='apicmd_reset_db'>reset_db</h3>
      <p>
        (Temporary command during development only) Reset (part of) the database (based on given arguments).
        <ul>
          <li>Optional argument: views: if set to 'yes', the command will delete all lyphviews in the database.</li>
          <li>Optional argument: lyphs: if set to 'yes', the command will delete all lyphs in the database.</li>
          <li>Optional argument: graph: if set to 'yes', the command will reset the graph to the original graph provided by Dr. de Bono.</li>
        </ul>
      </p>

    </div> <!-- divid -->
  </div> <!-- twelve columns -->

  <div class='four columns'>
    <h3>Quick Nav</h3>
    <hr>
    <ul>
      <li>&raquo; <a href='#about'>About</a></li>
      <li>
        &raquo; <a href='#api'>API</a>
        <ul>
          <li>&raquo; <a href='#apicmd_lyph'>lyph</a></li>
          <li>&raquo; <a href='#apicmd_layer'>layer</a></li>
          <li>&raquo; <a href='#apicmd_lyphedge'>lyphedge</a></li>
          <li>&raquo; <a href='#apicmd_lyphnode'>lyphnode</a></li>
          <li>&raquo; <a href='#apicmd_lyphpath'>lyphpath</a></li>
          <li>&raquo; <a href='#apicmd_assignlyph'>assignlyph</a></li>
          <li>&raquo; <a href='#apicmd_lyph_along_path'>lyph_along_path</a></li>
          <li>&raquo; <a href='#apicmd_constrain_along_path'>constrain_along_path</a></li>
          <li>&raquo; <a href='#apicmd_lyphview'>lyphview</a></li>
          <li>&raquo; <a href='#apicmd_makelayer'>makelayer</a></li>
          <li>&raquo; <a href='#apicmd_makelyph'>makelyph</a></li>
          <li>&raquo; <a href='#apicmd_makeview'>makeview</a></li>
          <li>&raquo; <a href='#apicmd_makelyphnode'>makelyphnode</a></li>
          <li>&raquo; <a href='#apicmd_makelyphedge'>makelyphedge</a></li>
          <li>&raquo; <a href='#apicmd_editedge'>editedge</a></li>
          <li>&raquo; <a href='#apicmd_editlyph'>editlyph</a></li>
          <li>&raquo; <a href='#apicmd_editview'>editview</a></li>
          <li>&raquo; <a href='#apicmd_editlayer'>editlayer</a></li>
          <li>&raquo; <a href='#apicmd_edgeconstrain'>edgeconstrain</a></li>
          <li>&raquo; <a href='#apicmd_sublyphs'>sublyphs</a></li>
        </ul>
      </li>
      <li>
        &raquo; Dev-only commands
        <ul>
          <li>&raquo; <a href='#apicmd_all_lyphs'>all_lyphs</a></li>
          <li>&raquo; <a href='#apicmd_all_lyphnodes'>all_lyphnodes</a></li>
          <li>&raquo; <a href='#apicmd_all_lyphedges'>all_lyphedges</a></li>
          <li>&raquo; <a href='#apicmd_all_lyphviews'>all_lyphviews</a></li>
          <li>&raquo; <a href='#apicmd_all_ont_terms'>all_ont_terms</a></li>
          <li>&raquo; <a href='#apicmd_lyph_hierarchy'>lyph_hierarchy</a></li>
          <li>&raquo; <a href='#apicmd_reset_db'>reset_db</a></li>
        </ul>
      </li>
    </ul>
  </div>  <!-- four columns -->

  <div class='sixteen columns'>
    <hr>
    <ul>
      <li>&raquo; <a href='#topdiv'>Back to top</a></li>
      <li>&raquo; <a href='doc.html'>Back to main LOLS documentation</a></li>
    </ul>
  </div>

</div>

</body>
</html>
