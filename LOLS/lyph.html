<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
<head>
<title>Lyphs Documentation</title>

<link rel="stylesheet" href="/Skeleton/stylesheets/base.css">
<link rel="stylesheet" href="/Skeleton/stylesheets/skeleton.css">

<style media='screen' type='text/css'>
#maindiv, #apidiv, #introdiv
{
  background-image: url(http://open-physiology.org/owlkb/swirly.png);
  background-position: center;
  background-size: contain;
  background-repeat: no-repeat;
}
</style>

</head>
<body>

<div class='container'>

  <div class='sixteen columns'>
    <h1 id='topdiv'>Lyphs Documentation</h1>
    <hr>
  </div>

  <div class='twelve columns' id='introdiv'>
    <div id='about'>
      <h2>About</h2>

      <h4>&raquo; <a href='#apidiv'>Quickjump to API section</a></h4>

      <p>
        Lyphs and lyph templates are special data structures developed for ApiNATOMY 2.
        They are intended for automated reasoning about flow
        processes through the body.
      </p>

      <h3>Templates</h3>

      <p>
        There are three types of template:
        <ul>
          <li>
            &raquo; Basic template: A <i>basic</i> template is just a term from a reference ontology
            (typically FMA or CHEBI).
          </li>
          <li>
            &raquo; Mix template: A <i>mix</i> template is an unordered list of <i>layers</i> (layers are
            defined below).
          </li>
          <li>
            &raquo; Shell template: A <i>shell</i> template is an ordered list of layers (defined below).
          </li>
        </ul>
      Every template has an <i>id</i>, used to retrieve the template from the database.
      </p>

      <h3>Layers</h3>
      <p>
        A <i>layer</i> is a template together with a thickness.
        If the layer consists of template X with thickness Y, we intuitively think
        of it as a right hollow cylinder constructed out of X (considered as
        a material), with thickness Y.  A layer's thickness can
        also be ``unspecified''.
      </p>
      <p>
        Every layer has an <i>id</i>, used for retrieval from the database.
      </p>

      <h3>Lyphnodes</h3>
      <p>
        A <i>lyphnode</i> is an entity whose only purpose is to serve as an
        endpoint of a <i>lyph</i> (defined below).  Every lyphnode has an
        <i>id</i>, for retrieval from the database.
      </p>
      <p>
        Every lyphnode also has a list of <i>exits</i> (an <i>exit</i> consists
        of a 'to' destination---which is another lyphnode---and a 'via' lyphedge).
        These <i>exits</i> are not user-defined; rather, they are automatically
        calculated from the lyphs.
      </p>

      <h3>Lyphs</h3>
      <p>
        A <i>lyph</i> consists of a 'from' vertex (which is a lyphnode,
        defined above); a 'to' vertex (also a lyphnode); a 'name' (which, in
        practice, may be a very verbose description of a segment of flow
        in the body); a 'type' (see below); a 'template' (which should be a 'shell'
        type of template); and an 'fma' term.  Only the 'from' and 'to' fields are
        mandatory, the rest may be unspecified.
      </p>
      <p>
        The 'type' of a lyph is one of the following:
        <ul>
          <li>1: arterial segment</li>
          <li>2: microcirculation</li>
          <li>3: venous</li>
          <li>4: cardiac chamber</li>
        </ul>
      </p>
      <p>
        Every lyph also has an <i>id</i>, for retrieval from the database.
      </p>

      <h3>Lyphviews</h3>
      <p>
        A <i>lyphview</i> is a set of lyphnodes along with x-y-coordinates
        for those lyphnodes.  Every lyphview also has an <i>id</i>, for retrieval
        from the database, and (optionally) a <i>name</i>.
      </p>
    </div>

    <div id='apidiv'>
      <h2>API</h2>
      <p>
        The Lyph API consists of commands which the user can send via
        HTTP.  The server sends its responses in JSON.  JSONP is supported.
      </p>

      <h3 id='apicmd_template'>template</h3>

      <p>
        Used to look up a template by its ID.
        <blockquote>
          Example: http://localhost:5052/template/TEMPLATE_1
        </blockquote>
        Note: You can specify a term in a reference ontology in order to retrieve the corresponding <i>basic template</i>.
        <blockquote>
          Example: http://localhost:5052/template/CHEBI_37527
        </blockquote>
      </p>

      <h3 id='apicmd_layer'>layer</h3>
      <p>
        Used to look up a layer by its ID.
        <blockquote>
          Example: http://localhost:5052/layer/LAYER_1
        </blockquote>
      </p>

      <h3 id='apicmd_lyphview'>lyphview</h3>
      <p>
        Used to look up a lyphview by its ID.
        <blockquote>
          Example: http://localhost:5052/lyphview/1
        </blockquote>
      </p>

      <h3 id='apicmd_lyph'>lyph</h3>
      <p>
        Used to look up a lyph by its ID.
        <blockquote>
          Example: http://localhost:5052/lyph/6039
        </blockquote>
      </p>

      <h3 id='apicmd_lyphnode'>lyphnode</h3>
      <p>
        Used to look up a lyphnode by its ID.
        <blockquote>
          Example: http://localhost:5052/lyphnode/50022150_0
        </blockquote>
      </p>

      <h3 id='apicmd_lyphpath'>lyphpath</h3>
      <p>
        Used to compute the shortest path from one lyphnode to another.
        <blockquote>
          Example: http://localhost:5052/lyphpath/?from=50022150_0&to=50022153_0
        </blockquote>
        Optional arguments:
        <ul>
          <li>&raquo; filter: specify a filter template, the algorithm will only consider lyphs with templates that are subtemplates of the filter.</li>
          <li>&raquo; include_templateless: specify ('yes' or 'no') whether templateless lyphs should be considered, when performing a filtered search.  Default: no.</li>
        </ul>
      </p>

      <h3 id='apicmd_assign_template'>assign_template</h3>
      <p>
        Used to assign a template to a lyph.
        <blockquote>
          Example: http://localhost:5052/assign_template/?lyph=5000&template=TEMPLATE_5
        </blockquote>
        Will send an error message if the indicated template is inconsistent (not a subtemplate of) any constraints previouly placed on the lyph.
      </p>

      <h3 id='apicmd_template_along_path'>template_along_path</h3>
      <p>
        Used to assign a template to every lyph along a path.
        <blockquote>
          Example: http://localhost:5052/template_along_path/?from=5000&to=6000&template=TEMPLATE_3
        </blockquote>
        Will send an error message (and not assign any templates) if any lyph in the path has constraints preventing this template from being assigned to it.
        <ul><li>Optional arguments: Same as the "lyphpath" command</li></ul>
      </p>

      <h3 id='apicmd_constrain_along_path'>constrain_along_path</h3>
      <p>
        Used to add a constraint to every lyph along a path.
        <blockquote>
          Example: http://localhost:5052/constrain_along_path/?from=5000&to=6000&template=TEMPLATE_3
        </blockquote>
        Will send an error message (and not assign any constraints) if any lyph in the path has a template that already violates the constraint.
        <ul><li>Optional arguments: Same as the "lyphpath" command</li></ul>
      </p>

      <h3 id='apicmd_lyphview'>lyphview</h3>
      <p>
        Used to look up a lyphview by its ID.
        <blockquote>
          Example: http://localhost:5052/lyphview/1
        </blockquote>
      </p>

      <h3 id='apicmd_makelayer'>makelayer</h3>
      <p>
        Used to create a new layer (or, if the specified layer already exists, retrieve it).
        <ul>
          <li>Mandatory argument: material: the material of the layer (a template ID)</li>
          <li>Optional argument: thickness: the thickness of the layer</li>
        </ul>
        <blockquote>
          Example: http://localhost:5052/makelayer/?material=TEMPLATE_1&thickness=5
        </blockquote>
      </p>

      <h3 id='apicmd_maketemplate'>maketemplate</h3>
        Used to create a new template (or, if the specified template already exists, find it).
        <ul>
          <li>
            Mandatory argument: name: a proposed name for the template.
            <ul>
              <li>Note: If a template already exists which matches everything else, then this proposed name will be discarded, in favor of the existing template's name.</li>
            </ul>
          </li>
          <li>
            Mandatory argument: type: mix or shell.
            <ul>
              <li>Note: To create a template of type 'basic', use the 'template' command (above).
            </ul>
          </li>
          <li>Mandatory arguments: layer1: specify layers of the template (by layer id)</li>
          <li>Optional arguments: layer2, layer3, layer4, etc: as above.
        </ul>
        <blockquote>
          Example: http://localhost:5052/maketemplate/?name=my+template&type=mix&layer1=LAYER_5&layer2=LAYER_77&layer3=LAYER_4
        </blockquote>

      <h3 id='apicmd_makeview'>makeview</h3>
      Used to create a new lyphview (or, if the specified view already exists, retrieve it).
      <ul>
        <li>Optional arguments: node1, node2, node3, ...: The nodes in the lyphview</li>
        <li>Optional arguments: x1, x2, x3, ...: The x-coordinates of the nodes</li>
        <li>Optional arguments: y1, y2, y3, ...: The y-coordinates of the nodes</li>
      </ul>
      Each node must be given an x- and a y-coordinate.
      <blockquote>
        Example: http://localhost:5052/makeview/?node1=500&x1=3&y1=5&node2=9342&x2=0&y2=0&node3=654&x3=99&y3=50
      </blockquote>

      <h3 id='apicmd_makelyphnode'>makelyphnode</h3>
      Used to create a new lyphnode.
      <ul>
        Optional argument: location: the location of the node (specified by a lyph ID).  If this argument is used, 'loctype' must also be used.
        Optional argument: loctype: the loctype of the node.  Can be 'interior' or 'border'.
      </ul>
      <blockquote>
        Example: http://localhost:5052/makelyphnode/?location=6039&loctype=interior
      </blockquote>
      Note: The lyphnode will not actually be saved to disk unless it is used in a lyph or lyphview.

      <h3 id='apicmd_makelyph'>makelyph</h3>
      Used to create a new lyph (or, if such a lyph already exists, retrieve it).
      <ul>
        <li>Mandatory argument: type: 1, 2, 3, or 4.  The meanings of these numbers are:
          <ul>
            <li>1: arterial segment</li>
            <li>2: microcirculation</li>
            <li>3: venous</li>
            <li>4: cardiac chamber</li>
          </ul>
        </li>
        <li>Optional argument: name: a description of the lyph.</li>
        <li>Mandatory argument: from: the initial node of the lyph (specified via lyphnode ID).</li>
        <li>Mandatory argument: to: the terminal node of the lyph (specified via lyphnode ID).</li>
        <li>Optional argument: template: a template to describe the tube around the edge (specified via template ID).
        <li>Optional argument: fma: an FMA term (specified as a number, e.g., 7197 refers to FMA_7197).</li>
      </ul>
      <blockquote>
        Example: http://localhost:5052/makelyph/?type=1&name=mystery+artery&from=5432&to=57465&template=TEMPLATE_5&fma=7197
      </blockquote>

      <h3 id='apicmd_editlyph'>editlyph</h3>
      <p>
        Used to edit an existing lyph.
        <ul>
          <li>Mandatory argument: lyph: the ID of the lyph to edit.</li>
          <li>Optional arguments: all the arguments that "makelyph" takes.</li>
        </ul>
      </p>

      <h3 id='apicmd_editlyphnode'>editlyphnode</h3>
      <p>
        Used to edit an existing lyphnode.
        <ul>
          <li>Argument: location: the location of the lyphnode (specified with a lyph ID).</li>
          <li>Argument: loctype: the loctype of the lyphnode ('interior' or 'border').</li>
        </ul>
        If the node already has a location, then the location argument is optional.
        If the node already has a loctype, then the loctype argument is optional.
      </p>

      <h3 id='apicmd_edit_template'>edit_template</h3>
      <p>
        Used to edit an existing template.
        <ul>
          <li>Mandatory argument: template: the ID of the template to edit.</li>
          <li>Optional arguments: name, type, ont</li>
        </ul>
      </p>

      <h3 id='apicmd_editview'>editview</h3>
      <p>
        Used to edit an existing lyphview.
        <ul>
          <li>Mandatory argument: view: the ID of the view to edit.</li>
          <li>Optional arguments: name</li>
        </ul>
      </p>

      <h3 id='apicmd_editlayer'>editlayer</h3>
      <p>
        Used to edit an existing layer.
        <ul>
          <li>Mandatory argument: layer: the ID of the layer to edit.</li>
          <li>Optional arguments: material, thickness</li>
        </ul>
      </p>

      <h3 id='apicmd_lyphconstrain'>lyphconstrain</h3>
      <p>
        Add a constraint to a lyph.  A constraint is a template, and what it does is it restricts which templates can be assigned to the lyph.  To be precise: only subtemplates of the constraint template will be allowed to be assigned to the lyph.
        <blockquote>
          Example: http://localhost:5052/lyphconstrain/?lyph=5000&template=TEMPLATE_5
        </blockquote>
      </p>

      <h3 id='apicmd_delete_lyphs'>delete_lyphs</h3>
      <p>
        Delete some lyphs.  The lyphs are specified via the 'lyphs' parameter, in the
        form of a comma-separated list.
        <blockquote>
          Example: http://localhost:5052/delete_lyphs/?lyphs=5000,6000,7000
        </blockquote>
      </p>

      <h3 id='apicmd_delete_nodes'>delete_nodes</h3>
      <p>
        Delete some nodes.  The nodes are specified via the 'nodes' parameter, in the
        form of a comma-separated list.  Note: any lyphs which have any of these nodes
        as endpoint, will also be deleted.
        <blockquote>
          Example: http://localhost:5052/delete_nodes/?nodes=50,60,70
        </blockquote>
      </p>

      <h3 id='apicmd_delete_templates'>delete_templates</h3>
      <p>
        Delete some templates.  The templates are specified via the 'templates' parameter, in the
        form of a comma-separated list.  Note: any templates/layers which are built-up from
        deleted templates will also be deleted.
        <blockquote>
          Example: http://localhost:5052/delete_templates/?templates=TEMPLATE_5,TEMPLATE_6,TEMPLATE_7
        </blockquote>
      </p>

      <h3 id='apicmd_delete_views'>delete_views</h3>
      <p>
        Delete some views.  The views are specified via the 'views' parameter, in the
        form of a comma-separated list.
        <blockquote>
          Example: http://localhost:5052/delete_views/?views=50,60,70
        </blockquote>
      </p>

      <h3 id='apicmd_delete_layers'>delete_layers</h3>
      <p>
        Delete some layers.  The layers are specified via the 'layers' parameter, in the
        form of a comma-separated list.  Note, any templates/layers built up from deleted
        layers will also be deleted.
        <blockquote>
          Example: http://localhost:5052/delete_layers/?layers=LAYER_1,LAYER_2,LAYER_3
        </blockquote>
      </p>

      <h3 id='nodes_to_view'>nodes_to_view</h3>
      <p>
        Add some nodes to a view.  The view is specified via the 'view' parameter.
        The nodes, along with their x- and y-coordinates, are specified via
        paramters 'node1', 'x1', 'y1', 'node2', 'x2', 'y2', etc., just like in the
        <a href='#apicmd_maketemplate'>maketemplate</a> command.  Note, if any of the
        indicated nodes are already in the view, they will be ignored (in particular
        the command will not override their existing x-y-coordinates).
        <blockquote>
          Example: http://localhost:5052/nodes_to_view/?view=5&node1=5000&x1=0&y1=3&node2=5001&x2=6&y2=90
        </blockquote>
      </p>

      <h3 id='nodes_from_view'>nodes_from_view</h3>
      <p>
        Remove some nodes from a view.  The view is specified with the 'view'
        parameter.  The nodes are specified with the 'nodes' parameter, in the
        form of a comma-separated list.  Note, any nodes in the list which are
        not in the view, will simply be ignored, so you don't have to worry about
        checking whether the nodes are already in the view, before sending the
        command.
        <blockquote>
          Example: http://localhost:5052/nodes_from_view/?view=5&nodes=5000,5001
        </blockquote>
      </p>

      <h3 id='apicmd_subtemplates'>subtemplates</h3>
      <p>
        List the subtemplates of the indicated template.
        <ul>
          <li>Mandatory argument: template: which template to view the subtemplates of.
          <li>Optional argument: direct: ('yes' or 'no') whether to restrict to only show *direct* subtemplates (default: 'no').
        </ul>
        <blockquote>
          Example: http://localhost:5052/subtemplates/?template=TEMPLATE_5&direct=yes
        </blockquote>
      </p>

      <h3 id='apicmd_all_templates'>all_templates</h3>
      <p>(Temporary command during development only) View all templates</p>

      <h3 id='apicmd_all_lyphnodes'>all_lyphnodes</h3>
      <p>(Temporary command during development only) View all lyphnodes</p>

      <h3 id='apicmd_all_lyphedges'>all_lyphs</h3>
      <p>(Temporary command during development only) View all lyphs</p>

      <h3 id='apicmd_all_lyphviews'>all_lyphviews</h3>
      <p>(Temporary command during development only) View all lyphviews</p>

      <h3 id='apicmd_all_ont_terms'>all_ont_terms</h3>
      <p>(Temporary command during development only) View all ontology terms</p>

      <h3 id='apicmd_template_hierarchy'>template_hierarchy</h3>
      <p>(Temporary command during development only) View the template hierarchy</p>

      <h3 id='apicmd_reset_db'>reset_db</h3>
      <p>
        (Temporary command during development only) Reset (part of) the database (based on given arguments).
        <ul>
          <li>Optional argument: views: if set to 'yes', the command will delete all lyphviews in the database.</li>
          <li>Optional argument: templates: if set to 'yes', the command will delete all templates in the database.</li>
          <li>Optional argument: graph: if set to 'yes', the command will reset the graph to the original graph provided by Dr. de Bono.</li>
        </ul>
      </p>

    </div> <!-- divid -->
  </div> <!-- twelve columns -->

  <div class='four columns'>
    <h3>Quick Nav</h3>
    <hr>
    <ul>
      <li>&raquo; <a href='#about'>About</a></li>
      <li>
        &raquo; <a href='#api'>API</a>
        <ul>
          <li>&raquo; <a href='#apicmd_template'>template</a></li>
          <li>&raquo; <a href='#apicmd_layer'>layer</a></li>
          <li>&raquo; <a href='#apicmd_lyph'>lyph</a></li>
          <li>&raquo; <a href='#apicmd_lyphnode'>lyphnode</a></li>
          <li>&raquo; <a href='#apicmd_lyphpath'>lyphpath</a></li>
          <li>&raquo; <a href='#apicmd_assign_template'>assign_template</a></li>
          <li>&raquo; <a href='#apicmd_template_along_path'>template_along_path</a></li>
          <li>&raquo; <a href='#apicmd_constrain_along_path'>constrain_along_path</a></li>
          <li>&raquo; <a href='#apicmd_lyphview'>lyphview</a></li>
          <li>&raquo; <a href='#apicmd_makelayer'>makelayer</a></li>
          <li>&raquo; <a href='#apicmd_maketemplate'>maketemplate</a></li>
          <li>&raquo; <a href='#apicmd_makeview'>makeview</a></li>
          <li>&raquo; <a href='#apicmd_makelyphnode'>makelyphnode</a></li>
          <li>&raquo; <a href='#apicmd_makelyph'>makelyph</a></li>
          <li>&raquo; <a href='#apicmd_editlyph'>editlyph</a></li>
          <li>&raquo; <a href='#apicmd_editlyphnode'>editlyphnode</a></li>
          <li>&raquo; <a href='#apicmd_edit_template'>edit_template</a></li>
          <li>&raquo; <a href='#apicmd_editview'>editview</a></li>
          <li>&raquo; <a href='#apicmd_editlayer'>editlayer</a></li>
          <li>&raquo; <a href='#apicmd_lyphconstrain'>lyphconstrain</a></li>
          <li>&raquo; <a href='#apicmd_delete_lyphs'>delete_lyphs</a></li>
          <li>&raquo; <a href='#apicmd_delete_nodes'>delete_nodes</a></li>
          <li>&raquo; <a href='#apicmd_delete_templates'>delete_templates</a></li>
          <li>&raquo; <a href='#apicmd_delete_views'>delete_views</a></li>
          <li>&raquo; <a href='#apicmd_delete_layers'>delete_layers</a></li>
          <li>&raquo; <a href='#apicmd_nodes_to_view'>nodes_to_view</a></li>
          <li>&raquo; <a href='#apicmd_nodes_from_view'>nodes_from_view</a></li>
          <li>&raquo; <a href='#apicmd_subtemplates'>subtemplates</a></li>
        </ul>
      </li>
      <li>
        &raquo; Dev-only commands
        <ul>
          <li>&raquo; <a href='#apicmd_all_templates'>all_templates</a></li>
          <li>&raquo; <a href='#apicmd_all_lyphnodes'>all_lyphnodes</a></li>
          <li>&raquo; <a href='#apicmd_all_lyphs'>all_lyphs</a></li>
          <li>&raquo; <a href='#apicmd_all_lyphviews'>all_lyphviews</a></li>
          <li>&raquo; <a href='#apicmd_all_ont_terms'>all_ont_terms</a></li>
          <li>&raquo; <a href='#apicmd_template_hierarchy'>template_hierarchy</a></li>
          <li>&raquo; <a href='#apicmd_reset_db'>reset_db</a></li>
        </ul>
      </li>
    </ul>
  </div>  <!-- four columns -->

  <div class='sixteen columns'>
    <hr>
    <ul>
      <li>&raquo; <a href='#topdiv'>Back to top</a></li>
      <li>&raquo; <a href='http://open-physiology.org'>Open Physiology</a></li>
    </ul>
  </div>

</div>

</body>
</html>
